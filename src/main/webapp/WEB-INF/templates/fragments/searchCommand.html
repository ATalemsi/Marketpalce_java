<div th:fragment="searchCommand">
    <input type="text" id="search-input" placeholder="Search commands..." oninput="searchCommand()"
           class="border rounded px-3 py-2 mr-2">

    <button class=" p-2 rounded">
        <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">

            <g id="SVGRepo_bgCarrier" stroke-width="0"/>

            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>

            <g id="SVGRepo_iconCarrier">
                <path d="M11 6C13.7614 6 16 8.23858 16 11M16.6588 16.6549L21 21M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z"
                      stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </g>

        </svg>
    </button>
    <div id="search-results"></div>

    <script>
        function searchCommand() {
            const input = document.getElementById('search-input').value;
            const searchResults = document.getElementById('search-results');
            let url = '/search/commands?';

            // Check if input is an ID or status
            if (!isNaN(input)) {
                url += 'id=' + input;
            } else {
                url += 'status=' + input;
            }
            const currentPath = window.location.pathname;

            const contextPath = currentPath.substring(0, currentPath.indexOf('/', 1));

            fetch( contextPath+ url)
                .then(response => {
                    if (response.ok) {
                        alert('Cart updated successfully!');

                    }
                    throw new Error('Network response was not ok.');
                })
                .then(data => {
                    console.log("Data received: ", data); // Vérifiez les données reçues
                    searchResults.innerHTML = ''; // Clear previous results
                    if (data.length === 0) {
                        searchResults.innerHTML = '<p>No commands found</p>';
                        return;
                    }
                    data.forEach(command => {
                        const div = document.createElement('div');
                        div.textContent = `ID: ${command.id}, Status: ${command.status}, Order Date: ${command.orderDate}`;
                        searchResults.appendChild(div);
                    });
                })
                .catch(error => {
                    console.error('Error fetching commands:', error);
                    searchResults.innerHTML = '<p>Error fetching commands</p>';
                });
        }

    </script>
</div>


